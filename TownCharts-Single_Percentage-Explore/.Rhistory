ylab('% Single')
ggtitle('Boxplots - % Single By State')
ggplot(data = population,
aes(x = State, y = Ratio_Single)) +
geom_boxplot(color = 'purple') +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab('State') +
ylab('% Single') +
ggtitle('Boxplots - % Single By State')
ggplot(data = subset(population, Ratio_Men_Single > 0),
aes(x = Ratio_Male,
y = Ratio_Men_Single)) +
geom_point(alpha = .1,
position = position_jitter(h = 0),
color = 'blue') +
geom_smooth(method = 'lm',
color = 'purple') +
xlim(0, 1) +
ylim(0, 1) +
xlab('% Male') +
ylab('% Men Single') +
ggtitle('Scatterplot - % Male By % Men Single')
ggplot(data = subset(population, Ratio_Women_Single > 0),
aes(x = Ratio_Female,
y = Ratio_Women_Single)) +
geom_point(alpha = .1,
position = position_jitter(h = 0),
color = 'red') +
geom_smooth(method = 'lm',
color = 'purple') +
xlim(0, 1) +
ylim(0, 1) +
xlab('% Female') +
ylab('% Women Single') +
ggtitle('Scatterplot - % Women Single Vs. % Female')
ggplot(data = population_subset,
aes(x = Ratio_Male,
y = Ratio_Men_Single,
color = Ratio_Under_30_Bucket)) +
geom_point(alpha = 0.5,
size = 2,
position = 'jitter') +
geom_smooth(method ='lm',
se = FALSE,
size = 1) +
scale_color_brewer(type = 'div',
guide = guide_legend(title = 'Percent Under 30',
reverse = TRUE)) +
scale_x_continuous(limits = c(0, .9)) +
scale_y_continuous(limits = c(0, .7)) +
xlab('% Male') +
ylab('% Men Single') +
ggtitle('Scatterplot - % Men Single Vs. % Male')
ggplot(data = population_subset,
aes(x = Ratio_Female,
y = Ratio_Women_Single,
color = Ratio_Under_30_Bucket)) +
geom_point(alpha = 0.5,
size = 2,
position = 'jitter') +
geom_smooth(method ='lm',
se = FALSE,
size = 1) +
scale_color_brewer(type = 'div',
guide = guide_legend(title = 'Percent Under 30',
reverse = TRUE)) +
scale_x_continuous(limits = c(0, .9)) +
scale_y_continuous(limits = c(0, .7)) +
xlab('% Female') +
ylab('% Women Single') +
ggtitle('Scatterplot - % Women Single Vs. % Female')
library(knitr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(GGally)
library(reshape2)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
population <- read.csv("population_data.csv")
ggplot(data = population,
aes(x = Ratio_Single)) +
geom_histogram(binwidth = .01,
fill = 'purple') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Single') +
ylab('Count By Area') +
ggtitle('Histogram - % Singles By Area')
summary(population$Ratio_Single)
ggplot(data = population, aes(x = State)) +
geom_histogram(stat = "count",
fill = 'green') +
xlab('State') +
ylab("Count of Areas") +
ggtitle('Histogram - Areas Per State') +
scale_y_continuous(limits = c(0, 3000)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data = population,
aes(x = Ratio_Male)) +
geom_histogram(binwidth = .01,
fill = 'blue') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Male') +
ylab("Count of Areas") +
ggtitle('Histogram - % Men By Area')
ggplot(data = population,
aes(x = Ratio_Female)) +
geom_histogram(binwidth = .01,
fill = 'red') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Female') +
ylab("Count of Areas") +
ggtitle('Histogram - % Women By Area')
summary(population$Ratio_Male)
summary(population$Ratio_Female)
population$Ratio_Men_Single <- population$Men.Single_Base /
population$POP_2015
population$Ratio_Women_Single <- population$Women.Single_Base /
population$POP_2015
ggplot(data = population,
aes(x = Ratio_Men_Single)) +
geom_histogram(binwidth = .01,
fill = 'blue') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Men Single') +
ylab("Count of Areas") +
ggtitle('Histogram - % Single Men By Area')
summary(population$Ratio_Men_Single)
ggplot(data = population,
aes(x = Ratio_Women_Single)) +
geom_histogram(binwidth = .01,
fill = 'red') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Women Single') +
ylab("Count of Areas") +
ggtitle('Histogram - % Single Women By Area')
summary(population$Ratio_Women_Single)
population$Ratio_Under_30 <- population$X.20 + population$X20s
ggplot(data = population,
aes(x = Ratio_Under_30)) +
geom_histogram(binwidth = .01,
fill = 'orange') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Under 30') +
ylab("Count of Areas") +
ggtitle('Histogram - % Under 30 By Area')
summary(population$Ratio_Under_30)
ggplot(data = population,
aes(x = State,
y = Ratio_Single)) +
geom_boxplot(color = 'purple') +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text.x = element_text(angle = 90,
hjust = 1)) +
xlab('State') +
ylab("% Single") +
ggtitle('Boxplots - % Single By State')
ggplot(data = population,
aes(x = State,
y = Ratio_Men_Single)) +
geom_point(stat = 'summary',
fun.y = "mean",
colour = 'blue') +
scale_y_continuous(limits = c(0, .25)) +
theme(axis.text.x = element_text(angle = 90,
hjust = 1)) +
xlab('State') +
ylab("% Single Men") +
ggtitle('Scatterplot - % Single Men By State')
ggplot(data = population,
aes(x = State,
y = Ratio_Women_Single)) +
geom_point(stat = 'summary',
fun.y = "mean",
colour = 'red') +
scale_y_continuous(limits = c(0, .25)) +
theme(axis.text.x = element_text(angle = 90,
hjust = 1)) +
xlab('State') +
ylab("% Single Women") +
ggtitle('Scatterplot - % Single Women By State')
ggplot(data = subset(population, Ratio_Men_Single > 0),
aes(x = Ratio_Male,
y = Ratio_Men_Single)) +
geom_point(alpha = .1,
position = position_jitter(h = 0),
color = 'blue') +
geom_smooth(method = 'lm',
color = 'purple') +
xlim(0, 1) +
ylim(0, 1) +
xlab('% Male') +
ylab("% Single Men") +
ggtitle('Scatterplot - % Single Men By % Men')
ggplot(data = subset(population, Ratio_Women_Single > 0),
aes(x = Ratio_Female,
y = Ratio_Women_Single)) +
geom_point(alpha = .1,
position = position_jitter(h = 0),
color = 'red') +
geom_smooth(method = 'lm',
color = 'purple') +
xlim(0, 1) +
ylim(0, 1) +
xlab('% Female') +
ylab("% Single Women") +
ggtitle('Scatterplot - % Single Women By % Female')
with(subset(population, Ratio_Women_Single > 0),
cor.test(Ratio_Female, Ratio_Women_Single, method = 'pearson'))
with(subset(population, Ratio_Men_Single > 0),
cor.test(Ratio_Male, Ratio_Men_Single, method = 'pearson'))
with(subset(population, Ratio_Women_Single > 0 & (Ratio_Female < .375 | Ratio_Female > .625)),
cor.test(Ratio_Female, Ratio_Women_Single, method = 'pearson'))
with(subset(population, Ratio_Men_Single > 0 & (Ratio_Male < .375 | Ratio_Male > .625)),
cor.test(Ratio_Male, Ratio_Men_Single, method = 'pearson'))
population_subset <- population[, c(5:6,30,61:63)]
names(population_subset)
ggcorr(population_subset, label = TRUE) +
ggtitle('Correlation Matrix')
population_subset$Ratio_Under_30_Bucket <- cut(population_subset$Ratio_Under_30,
c(0,.2, .4, .6, .8, 1))
ggplot(data = population_subset,
aes(x = Ratio_Male,
y = Ratio_Men_Single,
color = Ratio_Under_30_Bucket)) +
geom_point(alpha = 0.5,
size = 2,
position = 'jitter') +
geom_smooth(method ='lm',
se = FALSE,
size = 1) +
scale_color_brewer(type = 'div',
guide = guide_legend(title = 'Percent Under 30',
reverse = TRUE)) +
scale_x_continuous(limits = c(0, .9)) +
scale_y_continuous(limits = c(0, .7)) +
xlab('% Male') +
ylab("% Men Single") +
ggtitle('Scatterplot - % Single Men By % Male \n Group By Age')
ggplot(data = population_subset,
aes(x = Ratio_Female,
y = Ratio_Women_Single,
color = Ratio_Under_30_Bucket)) +
geom_point(alpha = 0.5,
size = 2,
position = 'jitter') +
geom_smooth(method ='lm',
se = FALSE,
size = 1) +
scale_color_brewer(type = 'div',
guide = guide_legend(title = 'Percent Under 30',
reverse = TRUE)) +
scale_x_continuous(limits = c(0, .9)) +
scale_y_continuous(limits = c(0, .7)) +
xlab('% Female') +
ylab("% Single Women") +
ggtitle('Scatterplot - % Single Women By % Female \n Group By Age')
ggplot(data = population,
aes(x = State, y = Ratio_Single)) +
geom_boxplot(color = 'purple') +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab('State') +
ylab('% Single') +
ggtitle('Boxplots - % Single By State')
ggplot(data = subset(population, Ratio_Men_Single > 0),
aes(x = Ratio_Male,
y = Ratio_Men_Single)) +
geom_point(alpha = .1,
position = position_jitter(h = 0),
color = 'blue') +
geom_smooth(method = 'lm',
color = 'purple') +
xlim(0, 1) +
ylim(0, 1) +
xlab('% Male') +
ylab('% Men Single') +
ggtitle('Scatterplot - % Men Single Vs. % Male')
ggplot(data = subset(population, Ratio_Women_Single > 0),
aes(x = Ratio_Female,
y = Ratio_Women_Single)) +
geom_point(alpha = .1,
position = position_jitter(h = 0),
color = 'red') +
geom_smooth(method = 'lm',
color = 'purple') +
xlim(0, 1) +
ylim(0, 1) +
xlab('% Female') +
ylab('% Women Single') +
ggtitle('Scatterplot - % Women Single Vs. % Female')
ggplot(data = population_subset,
aes(x = Ratio_Male,
y = Ratio_Men_Single,
color = Ratio_Under_30_Bucket)) +
geom_point(alpha = 0.5,
size = 2,
position = 'jitter') +
geom_smooth(method ='lm',
se = FALSE,
size = 1) +
scale_color_brewer(type = 'div',
guide = guide_legend(title = 'Percent Under 30',
reverse = TRUE)) +
scale_x_continuous(limits = c(0, .9)) +
scale_y_continuous(limits = c(0, .7)) +
xlab('% Male') +
ylab('% Men Single') +
ggtitle('Scatterplot - % Men Single Vs. % Male')
ggplot(data = population_subset,
aes(x = Ratio_Female,
y = Ratio_Women_Single,
color = Ratio_Under_30_Bucket)) +
geom_point(alpha = 0.5,
size = 2,
position = 'jitter') +
geom_smooth(method ='lm',
se = FALSE,
size = 1) +
scale_color_brewer(type = 'div',
guide = guide_legend(title = 'Percent Under 30',
reverse = TRUE)) +
scale_x_continuous(limits = c(0, .9)) +
scale_y_continuous(limits = c(0, .7)) +
xlab('% Female') +
ylab('% Women Single') +
ggtitle('Scatterplot - % Women Single Vs. % Female')
library(knitr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(GGally)
library(reshape2)
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
population <- read.csv("population_data.csv")
ggplot(data = population,
aes(x = Ratio_Single)) +
geom_histogram(binwidth = .01,
fill = 'purple') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Single') +
ylab('Count By Area') +
ggtitle('Histogram - % Singles By Area')
summary(population$Ratio_Single)
ggplot(data = population, aes(x = State)) +
geom_histogram(stat = "count",
fill = 'green') +
xlab('State') +
ylab("Count of Areas") +
ggtitle('Histogram - Areas Per State') +
scale_y_continuous(limits = c(0, 3000)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data = population,
aes(x = Ratio_Male)) +
geom_histogram(binwidth = .01,
fill = 'blue') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Male') +
ylab("Count of Areas") +
ggtitle('Histogram - % Men By Area')
ggplot(data = population,
aes(x = Ratio_Female)) +
geom_histogram(binwidth = .01,
fill = 'red') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Female') +
ylab("Count of Areas") +
ggtitle('Histogram - % Women By Area')
summary(population$Ratio_Male)
summary(population$Ratio_Female)
population$Ratio_Men_Single <- population$Men.Single_Base /
population$POP_2015
population$Ratio_Women_Single <- population$Women.Single_Base /
population$POP_2015
ggplot(data = population,
aes(x = Ratio_Men_Single)) +
geom_histogram(binwidth = .01,
fill = 'blue') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Men Single') +
ylab("Count of Areas") +
ggtitle('Histogram - % Single Men By Area')
summary(population$Ratio_Men_Single)
ggplot(data = population,
aes(x = Ratio_Women_Single)) +
geom_histogram(binwidth = .01,
fill = 'red') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Women Single') +
ylab("Count of Areas") +
ggtitle('Histogram - % Single Women By Area')
summary(population$Ratio_Women_Single)
ggplot(data = population,
aes(x = State,
y = Ratio_Single)) +
geom_boxplot(color = 'purple') +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text.x = element_text(angle = 90,
hjust = 1)) +
xlab('State') +
ylab("% Single") +
ggtitle('Boxplots - % Single By State')
ggplot(data = population,
aes(x = State,
y = Ratio_Men_Single)) +
geom_point(stat = 'summary',
fun.y = "mean",
colour = 'blue') +
scale_y_continuous(limits = c(0, .25)) +
theme(axis.text.x = element_text(angle = 90,
hjust = 1)) +
xlab('State') +
ylab("% Single Men") +
ggtitle('Scatterplot - % Single Men By State')
ggplot(data = population,
aes(x = State,
y = Ratio_Women_Single)) +
geom_point(stat = 'summary',
fun.y = "mean",
colour = 'red') +
scale_y_continuous(limits = c(0, .25)) +
theme(axis.text.x = element_text(angle = 90,
hjust = 1)) +
xlab('State') +
ylab("% Single Women") +
ggtitle('Scatterplot - % Single Women By State')
ggplot(data = subset(population, Ratio_Men_Single > 0),
aes(x = Ratio_Male,
y = Ratio_Men_Single)) +
geom_point(alpha = .1,
position = position_jitter(h = 0),
color = 'blue') +
geom_smooth(method = 'lm',
color = 'purple') +
xlim(0, 1) +
ylim(0, 1) +
xlab('% Male') +
ylab("% Single Men") +
ggtitle('Scatterplot - % Single Men By % Men')
ggplot(data = subset(population, Ratio_Women_Single > 0),
aes(x = Ratio_Female,
y = Ratio_Women_Single)) +
geom_point(alpha = .1,
position = position_jitter(h = 0),
color = 'red') +
geom_smooth(method = 'lm',
color = 'purple') +
xlim(0, 1) +
ylim(0, 1) +
xlab('% Female') +
ylab("% Single Women") +
ggtitle('Scatterplot - % Single Women By % Female')
with(subset(population, Ratio_Women_Single > 0),
cor.test(Ratio_Female, Ratio_Women_Single, method = 'pearson'))
with(subset(population, Ratio_Men_Single > 0),
cor.test(Ratio_Male, Ratio_Men_Single, method = 'pearson'))
with(subset(population, Ratio_Women_Single > 0 & (Ratio_Female < .375 | Ratio_Female > .625)),
cor.test(Ratio_Female, Ratio_Women_Single, method = 'pearson'))
with(subset(population, Ratio_Men_Single > 0 & (Ratio_Male < .375 | Ratio_Male > .625)),
cor.test(Ratio_Male, Ratio_Men_Single, method = 'pearson'))
population$Ratio_Under_30 <- population$X.20 + population$X20s
ggplot(data = population,
aes(x = Ratio_Under_30)) +
geom_histogram(binwidth = .01,
fill = 'orange') +
scale_x_continuous(limits = c(0, 1)) +
xlab('% Under 30') +
ylab("Count of Areas") +
ggtitle('Histogram - % Under 30 By Area')
summary(population$Ratio_Under_30)
population_subset <- population[, c(5:6,30,61:63)]
names(population_subset)
ggcorr(population_subset, label = TRUE) +
ggtitle('Correlation Matrix')
population_subset$Ratio_Under_30_Bucket <- cut(population_subset$Ratio_Under_30,
c(0,.2, .4, .6, .8, 1))
ggplot(data = population_subset,
aes(x = Ratio_Male,
y = Ratio_Men_Single,
color = Ratio_Under_30_Bucket)) +
geom_point(alpha = 0.5,
size = 2,
position = 'jitter') +
geom_smooth(method ='lm',
se = FALSE,
size = 1) +
scale_color_brewer(type = 'div',
guide = guide_legend(title = 'Percent Under 30',
reverse = TRUE)) +
scale_x_continuous(limits = c(0, .9)) +
scale_y_continuous(limits = c(0, .7)) +
xlab('% Male') +
ylab("% Men Single") +
ggtitle('Scatterplot - % Single Men By % Male \n Group By Age')
ggplot(data = population_subset,
aes(x = Ratio_Female,
y = Ratio_Women_Single,
color = Ratio_Under_30_Bucket)) +
geom_point(alpha = 0.5,
size = 2,
position = 'jitter') +
geom_smooth(method ='lm',
se = FALSE,
size = 1) +
scale_color_brewer(type = 'div',
guide = guide_legend(title = 'Percent Under 30',
reverse = TRUE)) +
scale_x_continuous(limits = c(0, .9)) +
scale_y_continuous(limits = c(0, .7)) +
xlab('% Female') +
ylab("% Single Women") +
ggtitle('Scatterplot - % Single Women By % Female \n Group By Age')
